!pip install spacy
!pip install newsapi-python
!pip install wheel
!pip install pandas

!python -m spacy download en_core_web_lg


import en_core_web_lg

nlp_eng = en_core_web_lg.load()
from newsapi.newsapi_client import NewsApiClient

newsapi = NewsApiClient (api_key='b85c86329035437f867a0a6fb2d05c9e')

articles=[]
for i in range(1,6):
    temp = newsapi.get_everything(q='coronavirus', language='en', from_param='2021-02-23', to='2021-03-22', sort_by='relevancy', page=i)
    articles.append(temp)
    
 
import pandas as pd     

dados=[]


for i, article in enumerate(articles):
    for x in article['articles']:
        title = x['title']
        description = x['description']
        content = x['content']
        date = x['publishedAt']
        dados.append({'title':title, 'date':date, 'desc':description, 'content':content})
df = pd.DataFrame(dados)
df = df.dropna()
df.head()

import spacy
import string 
nlp = spacy.load('en_core_web_lg')

pos_tag = ['PROPN', 'VERB', 'NOUN']


def get_keywords_eng(content):
    result=[]
    doc = nlp(content)
    for token in doc:
        if (token.text in nlp_eng.Defaults.stop_words or token.text in string.punctuation):
          continue
        if (token.pos_ in pos_tag):
          result.append(token.text)
    return result
 
 
 from collections import Counter

results=[]

for content in df.content.values:
    results.append([('#' + x[0]) for x in Counter(get_keywords_eng(content)).most_common(5)])
df['keywords'] = results


!pip install matplotlib
!pip install wordcloud

from wordcloud import WordCloud, STOPWORDS
import matplotlib.pyplot as plt

text = str(results)
wordcloud = WordCloud(max_font_size=50, max_words=100, background_color="white").generate(text)
plt.figure()
plt.imshow(wordcloud, interpolation="bilinear")
plt.axis("off")
plt.show()


print(df)
